<!DOCTYPE html>
<html>
<head>
  <title>AI Stock Trend Analyzer</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body{
      font-family: Arial;
      background:#f5f6fa;
      text-align:center;
    }
    .container{
      width:800px;
      margin:auto;
      margin-top:40px;
    }
    input,button{
      padding:10px;
      font-size:16px;
    }
    .card{
      background:white;
      padding:20px;
      margin-top:20px;
      border-radius:10px;
      box-shadow:0 2px 10px rgba(0,0,0,0.1);
    }
  </style>
</head>

<body>

<div class="container">

<h1>Indian Stock AI Trend Analyzer</h1>

<input id="symbol" placeholder="Enter stock (RELIANCE)" />
<button onclick="analyze()">Analyze</button>

<div id="analysis" class="card" style="display:none"></div>

<canvas id="chart" class="card"></canvas>

</div>

<script>
let chart;

async function analyze(){
  const symbol = document.getElementById("symbol").value;

  const res = await fetch("/api/analyze",{
    method:"POST",
    headers:{ "Content-Type":"application/json"},
    body: JSON.stringify({symbol})
  });

  const result = await res.json();

  // Show analysis
  document.getElementById("analysis").style.display="block";
  document.getElementById("analysis").innerHTML =
    `<h2>Trend: ${result.analysis.trend || result.analysis}</h2>
     <p>${result.analysis.explanation || ""}</p>`;

  // Chart
  const labels = result.data.map(d=>d.date);
  const prices = result.data.map(d=>d.close);

  if(chart) chart.destroy();

  chart = new Chart(document.getElementById("chart"),{
    type:'line',
    data:{
      labels:labels,
      datasets:[{
        label:"Price",
        data:prices,
        fill:false
      }]
    }
  });
}
</script>

</body>
</html>
